<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Attendance Tracker - School</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 1200px; margin: 0 auto; background: #fff; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); padding: 30px; }
    h1 { text-align: center; color: #333; margin-bottom: 30px; font-size: 2em; }
    
    .grade-select { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center; }
    .grade-btn { padding: 12px 20px; font-size: 1em; background: #e0e7ff; border: 2px solid #e0e7ff; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
    .grade-btn:hover { background: #c7d2fe; border-color: #667eea; }
    .grade-btn.active { background: #667eea; color: white; border-color: #667eea; }
    
    .lists-wrap { display: flex; gap: 20px; margin-bottom: 30px; }
    .list { flex: 1; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .list.present { background: #ecfdf5; border: 2px solid #10b981; }
    .list.absent { background: #fef2f2; border: 2px solid #ef4444; }
    .list.od { background: #fef3c7; border: 2px solid #f59e0b; }
    .list-title { font-weight: 700; margin-bottom: 15px; font-size: 1.1em; }
    .list.present .list-title { color: #10b981; }
    .list.absent .list-title { color: #ef4444; }
    .list.od .list-title { color: #f59e0b; }
    
    .student-list { max-height: 350px; overflow-y: auto; }
    .student-item { display: flex; align-items: center; gap: 10px; background: white; border: 1px solid #ddd; padding: 10px; margin-bottom: 8px; border-radius: 6px; transition: all 0.2s; }
    .student-item:hover { background: #f9fafb; }
    .student-checkbox { width: 18px; height: 18px; cursor: pointer; }
    .student-name { flex: 1; font-size: 0.95em; }
    .delete-btn { background: #ef4444; color: white; border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 0.85em; }
    .delete-btn:hover { background: #dc2626; }
    .move-btns { display: flex; gap: 10px; justify-content: center; margin-bottom: 15px; }
    .move-btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9em; transition: all 0.3s; }
    .move-to-absent { background: #ef4444; color: white; }
    .move-to-absent:hover:not(:disabled) { background: #dc2626; }
    .move-to-od { background: #f59e0b; color: white; }
    .move-to-od:hover:not(:disabled) { background: #d97706; }
    .move-btn:disabled { background: #cbd5e1; cursor: not-allowed; }
    .od-reason-input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; margin-top: 10px; font-size: 0.9em; }
    
    .action-btns { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
    .action-btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.95em; transition: all 0.3s; }
    .add-btn { background: #3b82f6; color: white; }
    .add-btn:hover:not(:disabled) { background: #2563eb; }
    .add-btn:disabled { background: #cbd5e1; cursor: not-allowed; }
    .all-present-btn { background: #10b981; color: white; }
    .all-present-btn:hover:not(:disabled) { background: #059669; }
    .all-present-btn:disabled { background: #cbd5e1; cursor: not-allowed; }
    
    .summary-area { background: #f8f9fa; border: 2px solid #667eea; border-radius: 10px; padding: 20px; margin-bottom: 30px; display: none; }
    .summary-title { font-weight: 700; margin-bottom: 15px; color: #667eea; font-size: 1.1em; }
    .summary-list { max-height: 300px; overflow-y: auto; }
    .summary-item { background: white; border-left: 4px solid #667eea; padding: 12px; margin-bottom: 10px; border-radius: 4px; }
    .summary-grade { font-weight: 700; color: #667eea; }
    .summary-stats { font-size: 0.9em; color: #666; margin: 5px 0; }
    .summary-names { font-size: 0.9em; color: #333; margin-top: 5px; line-height: 1.5; }
    .summary-od { font-size: 0.9em; color: #f59e0b; margin-top: 5px; line-height: 1.5; font-weight: 600; }
    .all-present-text { color: #10b981; font-weight: 700; }
    
    .clear-btn { background: #f3f4f6; color: #667eea; border: 1px solid #e5e7eb; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-weight: 600; float: right; }
    .clear-btn:hover { background: #e5e7eb; }
    
    .send-section { display: flex; flex-direction: column; gap: 15px; }
    .send-btn { padding: 14px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; font-size: 1.05em; transition: all 0.3s; }
    .send-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4); }
    .send-btn:disabled { background: #cbd5e1; cursor: not-allowed; }
    
    .status-msg { padding: 12px 15px; border-radius: 6px; display: none; font-weight: 600; margin-bottom: 10px; }
    .status-msg.success { background: #d1fae5; color: #065f46; border-left: 4px solid #10b981; display: block; }
    .status-msg.error { background: #fee2e2; color: #991b1b; border-left: 4px solid #ef4444; display: block; }
    
    @media (max-width: 1024px) {
      .lists-wrap { flex-direction: column; }
      .container { padding: 20px; }
      h1 { font-size: 1.5em; }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ðŸ“š Attendance Tracker</h1>

  <div class="grade-select" id="gradeSelect"></div>

  <div class="lists-wrap">
    <div class="list present">
      <div class="list-title">âœ“ Present Students <span id="presentCount">(0)</span></div>
      <div class="move-btns">
        <button class="move-btn move-to-absent" id="moveToAbsentBtn">Mark as Absent</button>
        <button class="move-btn move-to-od" id="moveToODBtn">Mark as OD</button>
      </div>
      <div class="student-list" id="presentList"></div>
    </div>
    <div class="list absent">
      <div class="list-title">âœ— Absentees List <span id="absentCount">(0)</span></div>
      <div class="student-list" id="absentList"></div>
    </div>
    <div class="list od">
      <div class="list-title">ðŸšŒ OD Students <span id="odCount">(0)</span></div>
      <input type="text" class="od-reason-input" id="odReasonInput" placeholder="Reason for OD (optional)">
      <div class="student-list" id="odList"></div>
    </div>
  </div>

  <div class="action-btns">
    <button class="action-btn add-btn" id="addToSummary">Add To Summary</button>
    <button class="action-btn all-present-btn" id="allPresentBtn">All Present</button>
  </div>

  <div class="summary-area" id="summaryArea">
    <div class="summary-title">ðŸ“‹ Summary for Sending</div>
    <div class="summary-list" id="summaryContent"></div>
    <button class="clear-btn" id="clearSummary">Clear Summary</button>
    <div style="clear: both;"></div>
  </div>

  <div class="send-section">
    <div id="statusMsg" class="status-msg"></div>
    <button class="send-btn" id="sendBtn">Send & Save to WhatsApp + Google Sheets</button>
  </div>
</div>

<script>
// ========== CONFIGURATION - EDIT HERE ==========
// Your Google Apps Script Webhook URL
const webhookUrl = 'https://script.googleapis.com/macros/d/YOUR_SCRIPT_ID/usercontent';

// Student data by grade
const studentData = {
  '9A': [
    'Mst.A D Ajmal Thohith', 'Ms.Lakshana G', 'Ms.Anu Rakshitha', 'Ms.Dhivya Darshini',
    'Ms.E Tejaswini', 'Ms.Muppiri Cheranvitha', 'Ms.Saie Jeevana J', 'Ms.Shamitha',
    'Ms.Sri Vaishnavi', 'Ms.Tappita Vernica Reddy', 'Ms.Von Valentina M.V.', 'Ms.Yashika R',
    'Mst Dhasvanth Kumar', 'Mst Krishna Nalagampalli Papudesi', 'Mst. E.Pawan', 'Mst.A.R.Parthiv',
    'Mst.Boothala Darshan Reddy', 'Mst.Harindranath', 'Mst.Harshith R', 'Mst.Jeevith Josh Kr',
    'Mst.Praneath', 'Mst.Prithvi', 'Mst.Roshan Praveen', 'Mst.Tarun Pranav S.B',
    'Ms.R Irene Janita', 'Mst.Tamilvelan S', 'Mst.Thrilok R', 'Mst.Vaitheesh Sai',
    'Mst.Venkatesan Sri Mallesh'
  ],
  '9B': [
    'Mst.Buvanesh Y', 'Ms.Hemavathi S', 'Ms Tarika', 'Ms.Joshna', 'Ms.Niranjana Sai',
    'Ms.Teja T', 'Mst.Krishna Karthik Buddi', 'Mst.Navyanth', 'Mst.Nivas P',
    'Mst.Vishwaa Karthik', 'Mst.Sujan C', 'Ms.Eniya V'
  ],
  '10A': [
    'Mst.Abhiram Dasari', 'Mst.Dhruv Charan', 'Ms.Eshita', 'Mst.Hariharan V.A',
    'Ms.Harshita V', 'Mst.Khethan Krishna K', 'Ms.Lasya M', 'Mst.Mohnish Reddy',
    'Mst.Monish', 'Mst.Mounish S', 'Mst.Muni Nihal B', 'Mst.Reddy Anish Vegamoor',
    'Mst.Saiteja', 'Ms.Shanvi Reddy', 'Mst.Shrinik Varshan', 'Mst.Vikas V'
  ],
  '10B': [
    'Mst.Aadhvan', 'Mst.Arunnatesan Srinivasan', 'Mst.Fehmaan Sk', 'Mst.Giri Shankar',
    'Ms.Gurram Varsha', 'Ms.Harini V.A', 'Mst.Hemanth V', 'Mst.Keerthi Vasan J',
    'Mst.Keerthi Vashan', 'Ms.Krishika', 'Mst.Nishanth C', 'Mst.Palasamudram Praneeth Sai',
    'Mst.Samuel Richards B', 'Mst.Saran', 'Mst.Sharad Bhushan S', 'Mst.Sunku Nagasai Nikiith',
    'Mst.Sunku Nagasai Nishith', 'Ms.Thaania Bhagirathi', 'Mst.Rishik'
  ],
  '11': [
    'Mst.Abimanyu.B', 'Mst.Abinav.S', 'Ms.Aditi Prasad', 'Mst.Aditya Raj Singh',
    'Mst.Ajay Krishna K P', 'Mst.Bachala Chetan Reddy', 'Mst.Berwin Reuben Varman',
    'Mst.Darshan K', 'Mst.Dinesh Karthik J', 'Mst.Ganesh N', 'Ms.Geerthana G',
    'Mst.Gowtham Vasudevan S', 'Mst. Haran Pranav E', 'Mst. Hrisheek Aryan Nunna',
    'Mst. Jaghadheesh G', 'Ms.Jai Asmitha', 'Ms.Jayashree C J', 'Ms.Kanishka V',
    'Mst.Krithik Sai Y', 'Mst.Nishanth T.S', 'Mst.Nithin B', 'Mst.Nitin Jose A',
    'Mst.Pranav N R S', 'Ms.Prithikha S', 'Mst.Raajarajan P S', 'Mst.Ramprasaad R G',
    'Mst.Renesh Jayaprapu', 'Mst.Sanjaiy Varman C M', 'Mst.Sanjeevee N', 'Mst.Sanjit Roshan',
    'Mst.Santhosh Sagar S', 'Mst.Saswin M', 'Mst.Sathyanathavarman A', 'Mst.Shankaranarayanan M',
    'Mst.Shanmugavarshini D M', 'Mst.Shylendar A K', 'Mst.Siddharth Dharshan D',
    'Mst.Srihari V', 'Mst.Surya S', 'Ms.Thanishka Mohan S', 'Mst.Tharun Easwar S',
    'Mst.Udhaya A', 'Mst.Vaishnav Chowdary', 'Mst.Varun S B', 'Mst.Vibhuraman'
  ],
  '12A': [
    'Mst.Adhitya Pranav', 'Ms.Bhavana', 'Mst.Bhuvan Harshaj', 'Mst.Chaitanya (Cbse)',
    'Mst.Chukisivam V', 'Mst.Dharan S V', 'Mst.Duttala Likith Reddy', 'Mst.Geethesh',
    'Mst.Guruthvik Reddy', 'Mst.Hanish', 'Mst.Harikaran', 'Ms.Harini (Cbse)',
    'Mst.Harish Ragavndar', 'Mst.Harshit V', 'Mst.Jaswant S', 'Mst.Jaswanth V',
    'Mst.Jeeva Surya', 'Mst.Kavensvar', 'Mst.Kavin Haritharan', 'Ms.Keerthana',
    'Ms.Kusuma Anjali', 'Ms.Lohitha T', 'Mst.Madavaneri Keshavardhan', 'Ms.Mahathi',
    'Mst. Manipi Sahith', 'Mst. Nikhil Sujith Kumar', 'Mst. Sai Nihal', 'Mst. Sainath S',
    'Mst.Sarvesh Raj', 'Mst.Sathyanarayana', 'Mst. Shiva Sri Raam', 'Mst. Shriram S',
    'Mst.Shubhranshu Saha', 'Mst.Sree Saravana Raju', 'Mst.Sreejan', 'Mst. Subbareddy Gari John Abhinav',
    'Mst.Sudharshan', 'Mst. Tarun Sai', 'Mst. Thanigaiselvan', 'Ms. Tharinishree',
    'Mst.Tharun Kumar', 'Mst.Vayila Ramcharan'
  ],
  '12B': [
    'Mst.Abhilash Paul', 'Ms.Kamalikaa', 'Mst.Kishore (Cs)', 'Mst.Nithish Kumar',
    'Mst.Raghulnathan S', 'Mst.Velsrinivas'
  ]
};
// ========== END CONFIGURATION ==========

let currentGrade = null;
let presentStudents = [];
let absentStudents = [];
let odStudents = [];
let summary = {};

const gradeSelect = document.getElementById('gradeSelect');
const presentList = document.getElementById('presentList');
const absentList = document.getElementById('absentList');
const odList = document.getElementById('odList');
const presentCount = document.getElementById('presentCount');
const absentCount = document.getElementById('absentCount');
const odCount = document.getElementById('odCount');
const addToSummaryBtn = document.getElementById('addToSummary');
const allPresentBtn = document.getElementById('allPresentBtn');
const summaryArea = document.getElementById('summaryArea');
const summaryContent = document.getElementById('summaryContent');
const clearSummaryBtn = document.getElementById('clearSummary');
const sendBtn = document.getElementById('sendBtn');
const statusMsg = document.getElementById('statusMsg');

function showStatus(message, isSuccess) {
  statusMsg.textContent = message;
  statusMsg.className = 'status-msg ' + (isSuccess ? 'success' : 'error');
  setTimeout(() => {
    statusMsg.className = 'status-msg';
  }, 5000);
}

function renderGrades() {
  gradeSelect.innerHTML = '';
  Object.keys(studentData).sort().forEach(grade => {
    const btn = document.createElement('button');
    btn.textContent = 'Grade ' + grade;
    btn.className = 'grade-btn';
    if (grade === currentGrade) btn.classList.add('active');
    btn.onclick = () => selectGrade(grade);
    gradeSelect.appendChild(btn);
  });
}

function selectGrade(grade) {
  currentGrade = grade;
  presentStudents = [...studentData[grade]];
  absentStudents = [];
  odStudents = [];
  renderLists();
  renderGrades();
}

function renderLists() {
  presentList.innerHTML = '';
  presentStudents.forEach(name => {
    const item = document.createElement('div');
    item.className = 'student-item';
    
    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.className = 'student-checkbox';
    checkbox.dataset.name = name;
    checkbox.onchange = () => updateMoveButtons();
    
    const nameSpan = document.createElement('span');
    nameSpan.className = 'student-name';
    nameSpan.textContent = name;
    
    item.appendChild(checkbox);
    item.appendChild(nameSpan);
    presentList.appendChild(item);
  });

  absentList.innerHTML = '';
  absentStudents.forEach(name => {
    const item = document.createElement('div');
    item.className = 'student-item';
    
    const nameSpan = document.createElement('span');
    nameSpan.className = 'student-name';
    nameSpan.textContent = name;
    
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'delete-btn';
    deleteBtn.textContent = 'Delete';
    deleteBtn.onclick = () => {
      absentStudents = absentStudents.filter(n => n !== name);
      presentStudents.push(name);
      renderLists();
    };
    
    item.appendChild(nameSpan);
    item.appendChild(deleteBtn);
    absentList.appendChild(item);
  });

  odList.innerHTML = '';
  odStudents.forEach(name => {
    const item = document.createElement('div');
    item.className = 'student-item';
    
    const nameSpan = document.createElement('span');
    nameSpan.className = 'student-name';
    nameSpan.textContent = name;
    
    const deleteBtn = document.createElement('button');
    deleteBtn.className = 'delete-btn';
    deleteBtn.textContent = 'Delete';
    deleteBtn.onclick = () => {
      odStudents = odStudents.filter(n => n !== name);
      presentStudents.push(name);
      renderLists();
    };
    
    item.appendChild(nameSpan);
    item.appendChild(deleteBtn);
    odList.appendChild(item);
  });

  presentCount.textContent = `(${presentStudents.length})`;
  absentCount.textContent = `(${absentStudents.length})`;
  odCount.textContent = `(${odStudents.length})`;
  
  updateMoveButtons();
  
  addToSummaryBtn.disabled = !currentGrade || (absentStudents.length === 0 && odStudents.length === 0);
  allPresentBtn.disabled = !currentGrade;
}

function updateMoveButtons() {
  const selectedCount = document.querySelectorAll('.student-checkbox:checked').length;
  const moveToAbsentBtn = document.getElementById('moveToAbsentBtn');
  const moveToODBtn = document.getElementById('moveToODBtn');
  if (moveToAbsentBtn) moveToAbsentBtn.disabled = selectedCount === 0;
  if (moveToODBtn) moveToODBtn.disabled = selectedCount === 0;
}

function buildSummaryMessage() {
  let today = new Date();
  const dstr = today.toLocaleDateString('en-IN');
  let msg = `${dstr}`;
  
  Object.entries(summary).forEach(([grade, data]) => {
    const total = studentData[grade].length;
    const presentCount = data.present.length + data.od.length;
    const absentCount = data.absent.length;
    
    msg += `\n\nGrade: ${grade}`;
    
    // Strength calculation with OD
    if (data.od.length > 0) {
      msg += `\nTotal: ${total}, Present: ${presentCount} (OD-${data.od.length}), Absent: ${absentCount}`;
    } else {
      msg += `\nTotal: ${total}, Present: ${presentCount}, Absent: ${absentCount}`;
    }
    
    // Add absentees
    if (data.absent.length === 0) {
      msg += `\nAll Present`;
    } else {
      msg += `\nAbsentees list:`;
      data.absent.forEach(nm => {
        msg += `\n${nm}`;
      });
    }
    
    // Add OD students only if they exist
    if (data.od.length > 0) {
      const odReason = data.odReason || '';
      if (odReason) {
        msg += `\nOD students (${odReason}):`;
      } else {
        msg += `\nOD students:`;
      }
      data.od.forEach(nm => {
        msg += `\n${nm}`;
      });
    }
  });
  
  return msg.trim();
}

function buildSheetsData() {
  let today = new Date();
  const dateStr = today.toLocaleDateString('en-IN');
  let data = {
    date: dateStr,
    entries: {}
  };

  Object.entries(summary).forEach(([grade, gradeData]) => {
    const total = studentData[grade].length;
    const present = gradeData.present.length + gradeData.od.length;
    const absent = gradeData.absent.length;
    data.entries[grade] = {
      total: total,
      present: present,
      absent: absent,
      absentees: gradeData.absent.length === 0 ? [] : gradeData.absent,
      od: gradeData.od.length === 0 ? [] : gradeData.od
    };
  });

  return data;
}

addToSummaryBtn.onclick = () => {
  if (currentGrade && (absentStudents.length > 0 || odStudents.length > 0)) {
    const odReason = document.getElementById('odReasonInput').value.trim();
    summary[currentGrade] = {
      present: [...presentStudents],
      absent: [...absentStudents],
      od: [...odStudents],
      odReason: odReason
    };
    renderSummary();
  }
};

allPresentBtn.onclick = () => {
  if (currentGrade) {
    summary[currentGrade] = {
      present: [...studentData[currentGrade]],
      absent: [],
      od: []
    };
    renderSummary();
  }
};

function renderSummary() {
  if (Object.keys(summary).length === 0) {
    summaryArea.style.display = 'none';
    sendBtn.disabled = true;
    return;
  }
  summaryArea.style.display = 'block';
  let summaryText = '';
  
  Object.entries(summary).forEach(([grade, gradeData]) => {
    const total = studentData[grade].length;
    const presentCount = gradeData.present.length + gradeData.od.length;
    const absentCount = gradeData.absent.length;
    
    summaryText += `<div class="summary-item">`;
    summaryText += `<div class="summary-grade">Grade ${grade}</div>`;
    
    // Strength calculation with OD
    if (gradeData.od.length > 0) {
      summaryText += `<div class="summary-stats">Total: ${total} | Present: ${presentCount} (OD-${gradeData.od.length}) | Absent: ${absentCount}</div>`;
    } else {
      summaryText += `<div class="summary-stats">Total: ${total} | Present: ${presentCount} | Absent: ${absentCount}</div>`;
    }
    
    // Show absentees
    if (gradeData.absent.length === 0) {
      summaryText += `<div class="summary-names"><span class="all-present-text">âœ“ All Present</span></div>`;
    } else {
      summaryText += `<div class="summary-names"><b>Absent:</b> ${gradeData.absent.join(', ')}</div>`;
    }
    
    // Show OD students only if they exist
    if (gradeData.od.length > 0) {
      const odReason = gradeData.odReason || '';
      if (odReason) {
        summaryText += `<div class="summary-od">ðŸšŒ OD (${odReason}): ${gradeData.od.join(', ')}</div>`;
      } else {
        summaryText += `<div class="summary-od">ðŸšŒ OD: ${gradeData.od.join(', ')}</div>`;
      }
    }
    
    summaryText += `</div>`;
  });
  
  summaryContent.innerHTML = summaryText;
  sendBtn.disabled = false;
}

clearSummaryBtn.onclick = () => {
  summary = {};
  renderSummary();
};

sendBtn.onclick = () => {
  if (!webhookUrl || webhookUrl === 'https://script.googleapis.com/macros/d/YOUR_SCRIPT_ID/usercontent') {
    showStatus('âš ï¸ Please configure webhook URL in the code', false);
    return;
  }

  if (Object.keys(summary).length === 0) {
    showStatus('âš ï¸ Please add at least one grade to summary', false);
    return;
  }

  sendBtn.disabled = true;
  const data = buildSheetsData();

  // Save to Google Sheets
  fetch(webhookUrl, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  })
  .then(() => {
    showStatus('âœ“ Data saved to Google Sheets', true);
    
    // Send to WhatsApp
    let msg = encodeURIComponent(buildSummaryMessage());
    window.open(`https://wa.me/?text=${msg}`, '_blank');
    
    setTimeout(() => {
      showStatus('âœ“ Sent to WhatsApp & Google Sheets successfully!', true);
      sendBtn.disabled = false;
    }, 800);
  })
  .catch(err => {
    showStatus('âœ— Error: ' + err.message, false);
    sendBtn.disabled = false;
  });
};

// Move to Absent button handler
document.getElementById('moveToAbsentBtn').addEventListener('click', () => {
  const checkboxes = document.querySelectorAll('.student-checkbox:checked');
  checkboxes.forEach(cb => {
    const name = cb.dataset.name;
    presentStudents = presentStudents.filter(n => n !== name);
    absentStudents.push(name);
  });
  renderLists();
});

// Move to OD button handler
document.getElementById('moveToODBtn').addEventListener('click', () => {
  const checkboxes = document.querySelectorAll('.student-checkbox:checked');
  checkboxes.forEach(cb => {
    const name = cb.dataset.name;
    presentStudents = presentStudents.filter(n => n !== name);
    odStudents.push(name);
  });
  renderLists();
});

renderGrades();
</script>
</body>
</html>
